# AI-Driven Self-Healing Locator Automation with Playwright + Cucumber

## Main Motive of This Project
The primary goal of this project is to **reduce flaky test failures caused by locator changes** on dynamic websites like Amazon.  
Instead of manually updating selectors when UI changes occur, we use an **AI-powered self-healing strategy**.  
This ensures that automation continues to run reliably, minimizing manual maintenance effort and saving significant time in the **STLC (Software Testing Life Cycle)** and **SDLC (Software Development Life Cycle)**.

---

## In Laymanâ€™s Terms
- Normally, when a button or input box changes its ID or CSS class, automated scripts break âŒ.
- Here, we teach the automation to be **smart enough to try multiple locator strategies** âœ….
- If all fail, it uses **AI-driven discovery** to find a new locator (like guessing intelligently).  
- That new locator is then **saved automatically** for future runs.  
- So, your automation **fixes itself instead of breaking**.

---

## Prompt We Used
```
You are an AI QA Agent with access to Playwright MCP Browser. Do the following and output a complete Playwright + Cucumber TypeScript project:

Open https://www.amazon.in (use the MCP browser).
For these target elements capture a small sanitized DOM snapshot (tag, id, name, aria-label, placeholder, class list, visible text and a short xpath):
Search bar (search input)
Search submit button
First product title on search results
First product price on search results
For each element, produce up to 5 locator strategies ordered by preference:
data-testid / data-* attributes
id
name
aria-label
input[placeholder*="search"] or contains text
CSS path using classes (shortest stable path)
XPath using contains() of text or attributes
Create a locators/amazon-locators.json file with keys: searchBar, searchButton, firstProductTitle, firstProductPrice. Each value is an array of selectors (strings).
Example:
{
"searchBar": ["input#twotabsearchtextbox", "input[name='field-keywords']", "input[aria-label*='Search']"],
...
}
Scaffold a small Playwright + Cucumber project (TypeScript) with these files:
package.json (script "test:bdd": "cucumber-js")
tsconfig.json
cucumber.js (or cucumber config)
playwright.config.ts (basic config)
features/amazon-search.feature (Gherkin scenario: search for "Apple 2025 MacBook Air")
features/step-definitions/amazon-steps.ts (Cucumber steps that read locators/amazon-locators.json and use locatorHelper)
features/support/world.ts and hooks.ts to initialize Playwright page for each scenario
support/locatorHelper.ts: implements async findElement(page, selectorArray, description):
tries each selector in order (await page.locator(sel).count() > 0)
if one succeeds, return locator and log which one worked
if none succeed, attempt a lightweight auto-discovery heuristic:
try input[aria-label*="search"], input[placeholder*="search"], input[type="search"], role=searchbox, or an xpath by visible text
if discovery finds an element, add it to the top of the JSON array for that key and write locators/amazon-locators.json back
always sanitize before writing (no full page html)
Step implementation details:
Step "When I search for <product>": load locators, call findElement for searchBar, fill product, click searchButton (from locators) or press Enter
Step "Then I should see product results for <expected>": find firstProductTitle, assert text contains expected
Additionally find firstProductPrice element, read textContent, normalize number (remove currency symbol and commas) and log both raw text and numeric value
Provide sample content of locators/amazon-locators.json you discovered, and include README.md with run steps:
npm install
npx playwright install
npm run test:bdd
Keep everything in TypeScript; avoid sending raw HTML or PII to external APIs. Use only short sanitized snapshots for discovery. Ensure scripts are robust to small changes and log updates to locators file when auto-discovery adds a selector.
Generate the entire project files in repository structure and show the created locators JSON and step file content.
```

---

## Step-by-Step Implementation Guide

### 1. Pre-requisites
- Install **Node.js** (LTS version recommended).
- Install **Visual Studio Code**.
- Ensure **Playwright MCP Server** and **VSCode AI agent** (GitHub Copilot / Cursor / Claude) are enabled.

### 2. Initialize the Project
```bash
mkdir AI_LOCATORS && cd AI_LOCATORS
npm init -y
npm install --save-dev @cucumber/cucumber playwright typescript ts-node
npx playwright install
```

### 3. Project Structure Auto-Generated by AI Prompt
```
AI_LOCATORS/
â”‚â”€â”€ features/
â”‚   â”œâ”€â”€ amazon-search.feature
â”‚   â””â”€â”€ step-definitions/amazon-steps.ts
â”‚â”€â”€ support/
â”‚   â”œâ”€â”€ hooks.ts
â”‚   â”œâ”€â”€ world.ts
â”‚   â””â”€â”€ locatorHelper.ts
â”‚â”€â”€ locators/
â”‚   â””â”€â”€ amazon-locators.json
â”‚â”€â”€ cucumber.js
â”‚â”€â”€ playwright.config.ts
â”‚â”€â”€ tsconfig.json
â”‚â”€â”€ package.json
â”‚â”€â”€ README.md
```

### 4. Run the Tests
```bash
npm run test:bdd
```

### 5. What Happens During Execution
- The script loads **amazon-locators.json**.
- It tries multiple locator strategies in priority order.
- If one locator works â†’ test continues.
- If none work â†’ AI **auto-discovers a new one**, updates `amazon-locators.json` automatically, and retries.

---

## Example Healing Scenario
1. Suppose Amazon changes the search bar ID from `#twotabsearchtextbox` to `#searchBoxMain`.
2. The script fails the first strategy, then tries fallback selectors (`name`, `aria-label`, `placeholder`, etc.).
3. If all fail, AI auto-discovers `input[placeholder*="Search"]`.
4. That selector is added to `amazon-locators.json`, and the test continues without manual update.

---

## Why This Matters
- Reduces **flaky test failures** ðŸš€
- Cuts down **manual locator maintenance** by 70â€“80% âš¡
- Demonstrates **AI + Playwright + BDD innovation** (trending in QA industry)

